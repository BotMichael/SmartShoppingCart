# -*- coding: utf-8 -*-

# Form implementation generated from reading rpi1 file '1.rpi1'
#
# Created by: PyQt5 UI code generator 5.15.0
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


import sys
#sys.path = sys.path+['', '/usr/lib/python37.zip', '/usr/lib/python3.7', '/usr/lib/python3.7/lib-dynload', '/home/pi/.local/lib/python3.7/site-packages', '/usr/local/lib/python3.7/dist-packages', '/usr/lib/python3/dist-packages']



from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QApplication, QMainWindow, QWidget, QPushButton

import time

# from TFLite_detection_face import face_activate
# from speech_rec import voice_recognition

from Edge_Client_RP1 import Edge_Client_RP1


# debug face
# import face_recognition
# image = face_recognition.load_image_file('FileStorage/sample_image.jpg')
sample_photo = open('FileStorage/sample_image.txt').read()


class First_UI(QMainWindow):
    def __init__(self):
        super(First_UI, self).__init__()
        self.setupUi()
    
    
    def setupUi(self):
        self.setObjectName("Welcome~")
        self.resize(450, 600)
        self.centralwidget = QtWidgets.QWidget(self)
        self.centralwidget.setObjectName("centralwidget")
        self.Welcome_banner = QtWidgets.QLabel(self.centralwidget)
        self.Welcome_banner.setGeometry(QtCore.QRect(40, 20, 301, 111))
        font = QtGui.QFont()
        font.setFamily("Comic Sans MS")
        font.setPointSize(48)
        self.Welcome_banner.setFont(font)
        self.Welcome_banner.setObjectName("Welcome_banner")

        #valueChanged = pyqtSignal()
        self.btn = QPushButton('Login', self)
        self.btn.setGeometry(330, 100, 100, 60)
        font = QtGui.QFont()
        font.setFamily("Comic Sans MS")
        font.setPointSize(24)
        self.btn.setFont(font)
        self.btn.clicked.connect(self.slot_btn_function)
 
        self.Discount = QtWidgets.QLabel(self.centralwidget)
        self.Discount.setGeometry(QtCore.QRect(30, 160, 400, 400))
        self.Discount.setText("")
        self.Discount.setPixmap(QtGui.QPixmap("FileStorage/dis.jpg"))
        self.Discount.setScaledContents(True)
        self.Discount.setObjectName("Discount")

#        self.slot_btn_function()
        self.setCentralWidget(self.centralwidget)
        self.statusbar = QtWidgets.QStatusBar(self)
        self.statusbar.setObjectName("statusbar")
        self.setStatusBar(self.statusbar)
        
        self.retranslateUi(self)
        QtCore.QMetaObject.connectSlotsByName(self)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "Welcome"))
        self.Welcome_banner.setText(_translate("MainWindow", "Welcome!"))

##    def login(self):
##        self.switch_window.emit()

    def slot_btn_function(self):
        self.hide()

        from Edge_Client_RP1 import Edge_Client_RP1
#        from TFLite_detection_face import face_activate

        #request, photo = face_activate()
        request, photo = "activate_system", sample_photo  # for debug
        while request != "activate_system":
            pass

            # request, photo = face_activate()

        photo = "[-0.14963729679584503, 0.1397586613893509, 0.05048971623182297, -0.12839658558368683, -0.23499929904937744, -0.09751374274492264, -0.005986516363918781, -0.12343404442071915, 0.18281465768814087, -0.11205802857875824, 0.15691791474819183, -0.07306629419326782, -0.1808769702911377, 0.10577774047851562, -0.12095507234334946, 0.1471470445394516, -0.17249074578285217, -0.22062301635742188, -0.022238491103053093, -0.07814091444015503, 0.11274328827857971, -0.03858374059200287, -0.05755264312028885, 0.14649760723114014, -0.030101733282208443, -0.259671688079834, -0.09247714281082153, 0.030765753239393234, 0.10117898136377335, -0.07128741592168808, 0.07394450902938843, 0.12023892998695374, -0.20632584393024445, -0.027308909222483635, 0.008459446020424366, 0.07421093434095383, -0.03047860786318779, -0.17808116972446442, 0.14162416756153107, -0.006580132059752941, -0.2685408592224121, -0.03656528517603874, 0.04957861453294754, 0.32472339272499084, 0.1735781729221344, -0.014861177653074265, 0.014178196899592876, -0.07696407288312912, 0.034000836312770844, -0.2739402651786804, 0.0025311466306447983, 0.23398402333259583, 0.008222402073442936, 0.030736543238162994, 0.02311500906944275, -0.20036476850509644, 0.08482343703508377, 0.11658984422683716, -0.21983718872070312, 0.04067327454686165, 0.11125358939170837, -0.15124815702438354, 0.034879036247730255, -0.18195264041423798, 0.20852939784526825, 0.17534708976745605, -0.10648447275161743, -0.21469396352767944, 0.1621522307395935, -0.19762562215328217, -0.09234946221113205, 0.08312509208917618, -0.14381945133209229, -0.17510513961315155, -0.2673981189727783, 0.013070962391793728, 0.4876844584941864, 0.26571086049079895, -0.0724213495850563, 0.08782181888818741, -0.056516919285058975, 0.006021495442837477, 0.04392394423484802, 0.21712413430213928, -0.04046148061752319, -0.00912674330174923, -0.13634920120239258, 0.04323352128267288, 0.13500210642814636, -0.0002165893092751503, -0.10892950743436813, 0.20835119485855103, -0.010085487738251686, -0.06002464145421982, -0.03703552857041359, 0.0839087963104248, -0.16412459313869476, 0.0488498687744, -0.14334863424301, -0.50100040436, -0.681137085, -0.006990503, -0.5559387207, 0.199974, -0.170852002, 0.181, -0.28845, 0.03433, -0.6227, -0.99527, 0.27807, -0.6318, 0.9995651, -0.6726532, 0.9630127, 0.1940, 0.059, 0.157, 0.069, 0.5, 0.07, -0.08, -0.1431, -0.1, -0.945, -0.04, 0.0, 0.054]"
        rpi1 = Edge_Client_RP1()
        rpi1.init_session()
        message = rpi1.login(photo)
        if message["status"] == 1:
            from RegisterMenu import RegisterMenu
            self.s = RegisterMenu(photo)  # register page
            self.s.show()

        elif message["status"] == 0:
            from Menu import ui_Menu
            self.s = ui_Menu()
            self.s.show()

def main():
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = First_UI()
    ui.setupUi()
    ui.show()
    sys.exit(app.exec_())
    

if __name__ == "__main__":
    main()



   











